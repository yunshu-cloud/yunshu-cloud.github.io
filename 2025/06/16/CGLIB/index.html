<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Understanding Java Proxy Patterns - JDK Dynamic Proxy vs CGLIB | VictorHolmes Blog</title><meta name="author" content="victor holmes"><meta name="copyright" content="victor holmes"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Java Proxy Patterns: JDK Dynamic Proxy vs CGLIBIntroduction to Proxy PatternsIn modern Java applications, especially those built with Spring Framework, proxy patterns play a crucial role in implementi">
<meta property="og:type" content="article">
<meta property="og:title" content="Understanding Java Proxy Patterns - JDK Dynamic Proxy vs CGLIB">
<meta property="og:url" content="http://example.com/2025/06/16/CGLIB/index.html">
<meta property="og:site_name" content="VictorHolmes Blog">
<meta property="og:description" content="Java Proxy Patterns: JDK Dynamic Proxy vs CGLIBIntroduction to Proxy PatternsIn modern Java applications, especially those built with Spring Framework, proxy patterns play a crucial role in implementi">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/img/butterfly-icon.png">
<meta property="article:published_time" content="2025-06-16T06:32:40.000Z">
<meta property="article:modified_time" content="2025-08-07T06:25:45.296Z">
<meta property="article:author" content="victor holmes">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="Spring">
<meta property="article:tag" content="Proxy Pattern">
<meta property="article:tag" content="CGLIB">
<meta property="article:tag" content="AOP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/butterfly-icon.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Understanding Java Proxy Patterns - JDK Dynamic Proxy vs CGLIB",
  "url": "http://example.com/2025/06/16/CGLIB/",
  "image": "http://example.com/img/butterfly-icon.png",
  "datePublished": "2025-06-16T06:32:40.000Z",
  "dateModified": "2025-08-07T06:25:45.296Z",
  "author": [
    {
      "@type": "Person",
      "name": "victor holmes",
      "url": "http://example.com/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/2025/06/16/CGLIB/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Understanding Java Proxy Patterns - JDK Dynamic Proxy vs CGLIB',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="VictorHolmes Blog" type="application/atom+xml">
</head><body><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">VictorHolmes Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Understanding Java Proxy Patterns - JDK Dynamic Proxy vs CGLIB</span></a></span><div id="menus"></div></nav><div id="post-info"><h1 class="post-title">Understanding Java Proxy Patterns - JDK Dynamic Proxy vs CGLIB</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-06-16T06:32:40.000Z" title="Created 2025-06-16 14:32:40">2025-06-16</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-08-07T06:25:45.296Z" title="Updated 2025-08-07 14:25:45">2025-08-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java-Development/">Java Development</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java-Development/Design-Patterns/">Design Patterns</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Java-Proxy-Patterns-JDK-Dynamic-Proxy-vs-CGLIB"><a href="#Java-Proxy-Patterns-JDK-Dynamic-Proxy-vs-CGLIB" class="headerlink" title="Java Proxy Patterns: JDK Dynamic Proxy vs CGLIB"></a>Java Proxy Patterns: JDK Dynamic Proxy vs CGLIB</h1><h2 id="Introduction-to-Proxy-Patterns"><a href="#Introduction-to-Proxy-Patterns" class="headerlink" title="Introduction to Proxy Patterns"></a>Introduction to Proxy Patterns</h2><p>In modern Java applications, especially those built with Spring Framework, proxy patterns play a crucial role in implementing cross-cutting concerns such as:</p>
<ul>
<li>Logging and monitoring</li>
<li>Transaction management</li>
<li>Security and authentication</li>
<li>Caching</li>
<li>Method execution timing</li>
</ul>
<p>These concerns often need to be applied across multiple components without modifying their source code. Proxy patterns provide an elegant solution by intercepting method calls and adding behavior before, after, or around the original method execution.</p>
<p>Java offers two primary approaches to creating proxies at runtime:</p>
<ol>
<li>JDK Dynamic Proxy (built into the Java standard library)</li>
<li>CGLIB (Code Generation Library, a third-party solution)</li>
</ol>
<p>This article explores both approaches, highlighting their differences, use cases, and implementation details.</p>
<h2 id="JDK-Dynamic-Proxy"><a href="#JDK-Dynamic-Proxy" class="headerlink" title="JDK Dynamic Proxy"></a>JDK Dynamic Proxy</h2><p>JDK Dynamic Proxy is Java’s built-in mechanism for creating proxy objects at runtime. It’s part of the core Java reflection API and doesn’t require any additional dependencies.</p>
<h3 id="Key-Characteristics"><a href="#Key-Characteristics" class="headerlink" title="Key Characteristics"></a>Key Characteristics</h3><ul>
<li><strong>Interface-based</strong>: Only works with interfaces; the target class must implement at least one interface</li>
<li><strong>Reflection-based</strong>: Uses Java’s reflection API to intercept method calls</li>
<li><strong>Standard library</strong>: Included in the JDK, no external dependencies required</li>
<li><strong>Performance</strong>: Generally fast, but slightly slower than direct method calls</li>
</ul>
<h3 id="How-JDK-Dynamic-Proxy-Works"><a href="#How-JDK-Dynamic-Proxy-Works" class="headerlink" title="How JDK Dynamic Proxy Works"></a>How JDK Dynamic Proxy Works</h3><ol>
<li>You define an <code>InvocationHandler</code> implementation that contains the proxy behavior</li>
<li>The JDK creates a proxy class that implements all interfaces of the target class</li>
<li>Method calls on the proxy are intercepted and delegated to the <code>InvocationHandler</code></li>
<li>The handler can execute custom logic before&#x2F;after invoking the original method</li>
</ol>
<h3 id="Implementation-Example"><a href="#Implementation-Example" class="headerlink" title="Implementation Example"></a>Implementation Example</h3><h4 id="1-Define-an-Interface"><a href="#1-Define-an-Interface" class="headerlink" title="1. Define an Interface"></a>1. Define an Interface</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">addUser</span><span class="params">(String username)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteUser</span><span class="params">(String username)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-Implement-the-Interface"><a href="#2-Implement-the-Interface" class="headerlink" title="2. Implement the Interface"></a>2. Implement the Interface</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addUser</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Adding user: &quot;</span> + username);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteUser</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Deleting user: &quot;</span> + username);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-Create-an-InvocationHandler"><a href="#3-Create-an-InvocationHandler" class="headerlink" title="3. Create an InvocationHandler"></a>3. Create an InvocationHandler</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationHandler;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoggingHandler</span> <span class="keyword">implements</span> <span class="title class_">InvocationHandler</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Object target;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LoggingHandler</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.target = target;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Method &quot;</span> + method.getName() + <span class="string">&quot; is being called with arguments: &quot;</span> + args[<span class="number">0</span>]);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> method.invoke(target, args);  <span class="comment">// Delegates to actual method</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Method &quot;</span> + method.getName() + <span class="string">&quot; execution finished.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-Create-and-Use-the-Proxy"><a href="#4-Create-and-Use-the-Proxy" class="headerlink" title="4. Create and Use the Proxy"></a>4. Create and Use the Proxy</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Proxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// Create the original object</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">userService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserServiceImpl</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create a proxy for the UserService interface</span></span><br><span class="line">        <span class="type">UserService</span> <span class="variable">proxy</span> <span class="operator">=</span> (UserService) Proxy.newProxyInstance(</span><br><span class="line">                userService.getClass().getClassLoader(),</span><br><span class="line">                userService.getClass().getInterfaces(),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">LoggingHandler</span>(userService)</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Call methods on the proxy</span></span><br><span class="line">        proxy.addUser(<span class="string">&quot;John Doe&quot;</span>);</span><br><span class="line">        proxy.deleteUser(<span class="string">&quot;John Doe&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Method addUser is being called with arguments: John Doe</span><br><span class="line">Adding user: John Doe</span><br><span class="line">Method addUser execution finished.</span><br><span class="line">Method deleteUser is being called with arguments: John Doe</span><br><span class="line">Deleting user: John Doe</span><br><span class="line">Method deleteUser execution finished.</span><br></pre></td></tr></table></figure>

<h2 id="CGLIB-Proxy"><a href="#CGLIB-Proxy" class="headerlink" title="CGLIB Proxy"></a>CGLIB Proxy</h2><p>CGLIB (Code Generation Library) is a powerful, high-performance code generation library that extends Java’s proxy capabilities beyond interfaces. It’s widely used in frameworks like Spring and Hibernate.</p>
<h3 id="Key-Characteristics-1"><a href="#Key-Characteristics-1" class="headerlink" title="Key Characteristics"></a>Key Characteristics</h3><ul>
<li><strong>Class-based</strong>: Works with concrete classes; no interface required</li>
<li><strong>Bytecode generation</strong>: Generates bytecode at runtime to create subclasses</li>
<li><strong>External dependency</strong>: Requires the CGLIB library</li>
<li><strong>Performance</strong>: Generally fast, comparable to JDK proxies</li>
<li><strong>Limitations</strong>: Cannot proxy final classes or methods</li>
</ul>
<h3 id="How-CGLIB-Works"><a href="#How-CGLIB-Works" class="headerlink" title="How CGLIB Works"></a>How CGLIB Works</h3><ol>
<li>CGLIB creates a subclass of the target class at runtime</li>
<li>The generated subclass overrides non-final methods of the target class</li>
<li>Method calls on the proxy are intercepted by a <code>MethodInterceptor</code></li>
<li>The interceptor can execute custom logic before&#x2F;after invoking the original method</li>
</ol>
<h3 id="Implementation-Example-1"><a href="#Implementation-Example-1" class="headerlink" title="Implementation Example"></a>Implementation Example</h3><h4 id="1-Add-CGLIB-Dependency"><a href="#1-Add-CGLIB-Dependency" class="headerlink" title="1. Add CGLIB Dependency"></a>1. Add CGLIB Dependency</h4><p>If using Maven:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-Create-a-Target-Class-No-Interface-Required"><a href="#2-Create-a-Target-Class-No-Interface-Required" class="headerlink" title="2. Create a Target Class (No Interface Required)"></a>2. Create a Target Class (No Interface Required)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addUser</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Adding user: &quot;</span> + username);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteUser</span><span class="params">(String username)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Deleting user: &quot;</span> + username);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-Create-and-Use-the-CGLIB-Proxy"><a href="#3-Create-and-Use-the-CGLIB-Proxy" class="headerlink" title="3. Create and Use the CGLIB Proxy"></a>3. Create and Use the CGLIB Proxy</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.Enhancer;</span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.MethodInterceptor;</span><br><span class="line"><span class="keyword">import</span> net.sf.cglib.proxy.MethodProxy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CglibProxyExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// Create CGLIB proxy for UserServiceImpl</span></span><br><span class="line">        <span class="type">Enhancer</span> <span class="variable">enhancer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Enhancer</span>();</span><br><span class="line">        enhancer.setSuperclass(UserServiceImpl.class);</span><br><span class="line">        enhancer.setCallback((MethodInterceptor) (proxy, method, args1, methodProxy) -&gt; &#123;</span><br><span class="line">            <span class="comment">// Pre-method logic: Logging</span></span><br><span class="line">            System.out.println(<span class="string">&quot;Method &quot;</span> + method.getName() + <span class="string">&quot; is being called with arguments: &quot;</span> + args1[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Call the original method on the target class</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> methodProxy.invokeSuper(proxy, args1);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Post-method logic: Logging</span></span><br><span class="line">            System.out.println(<span class="string">&quot;Method &quot;</span> + method.getName() + <span class="string">&quot; execution finished.&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Create the proxy instance</span></span><br><span class="line">        <span class="type">UserServiceImpl</span> <span class="variable">proxy</span> <span class="operator">=</span> (UserServiceImpl) enhancer.create();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Call methods on the proxy</span></span><br><span class="line">        proxy.addUser(<span class="string">&quot;John Doe&quot;</span>);</span><br><span class="line">        proxy.deleteUser(<span class="string">&quot;John Doe&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Output-1"><a href="#Output-1" class="headerlink" title="Output"></a>Output</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Method addUser is being called with arguments: John Doe</span><br><span class="line">Adding user: John Doe</span><br><span class="line">Method addUser execution finished.</span><br><span class="line">Method deleteUser is being called with arguments: John Doe</span><br><span class="line">Deleting user: John Doe</span><br><span class="line">Method deleteUser execution finished.</span><br></pre></td></tr></table></figure>

<h2 id="Comparing-JDK-Dynamic-Proxy-and-CGLIB"><a href="#Comparing-JDK-Dynamic-Proxy-and-CGLIB" class="headerlink" title="Comparing JDK Dynamic Proxy and CGLIB"></a>Comparing JDK Dynamic Proxy and CGLIB</h2><table>
<thead>
<tr>
<th>Feature</th>
<th>JDK Dynamic Proxy</th>
<th>CGLIB</th>
</tr>
</thead>
<tbody><tr>
<td>Target requirements</td>
<td>Must implement interface(s)</td>
<td>Can be any non-final class</td>
</tr>
<tr>
<td>Method requirements</td>
<td>Any method declared in interface</td>
<td>Any non-final method</td>
</tr>
<tr>
<td>Dependencies</td>
<td>None (part of JDK)</td>
<td>External CGLIB library</td>
</tr>
<tr>
<td>Performance</td>
<td>Good</td>
<td>Good, sometimes better</td>
</tr>
<tr>
<td>Memory usage</td>
<td>Lower</td>
<td>Higher (generates classes)</td>
</tr>
<tr>
<td>Proxy creation time</td>
<td>Faster</td>
<td>Slower (class generation)</td>
</tr>
<tr>
<td>Spring usage</td>
<td>Default for interface-based beans</td>
<td>Used for concrete classes</td>
</tr>
</tbody></table>
<h2 id="When-to-Use-Each-Approach"><a href="#When-to-Use-Each-Approach" class="headerlink" title="When to Use Each Approach"></a>When to Use Each Approach</h2><h3 id="Use-JDK-Dynamic-Proxy-When"><a href="#Use-JDK-Dynamic-Proxy-When" class="headerlink" title="Use JDK Dynamic Proxy When:"></a>Use JDK Dynamic Proxy When:</h3><ul>
<li>Your target classes implement interfaces</li>
<li>You want to avoid external dependencies</li>
<li>You’re working in environments with restricted class loading</li>
<li>Memory footprint is a concern</li>
</ul>
<h3 id="Use-CGLIB-When"><a href="#Use-CGLIB-When" class="headerlink" title="Use CGLIB When:"></a>Use CGLIB When:</h3><ul>
<li>Your target classes don’t implement interfaces</li>
<li>You need to proxy concrete classes</li>
<li>You need to proxy specific methods not defined in interfaces</li>
<li>You’re already using a framework that includes CGLIB (like Spring)</li>
</ul>
<h2 id="How-Spring-Framework-Uses-Proxies"><a href="#How-Spring-Framework-Uses-Proxies" class="headerlink" title="How Spring Framework Uses Proxies"></a>How Spring Framework Uses Proxies</h2><p>Spring Framework uses both proxy mechanisms depending on the situation:</p>
<ol>
<li><p><strong>For @Transactional, @Cacheable, and other AOP annotations:</strong></p>
<ul>
<li>If the target bean implements at least one interface: JDK Dynamic Proxy (by default)</li>
<li>If the target bean doesn’t implement any interface: CGLIB</li>
</ul>
</li>
<li><p><strong>Configuration:</strong></p>
<ul>
<li>Spring allows forcing CGLIB for all proxies via configuration:<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableAspectJAutoProxy(proxyTargetClass = true)</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h2 id="Limitations-and-Considerations"><a href="#Limitations-and-Considerations" class="headerlink" title="Limitations and Considerations"></a>Limitations and Considerations</h2><h3 id="JDK-Dynamic-Proxy-Limitations"><a href="#JDK-Dynamic-Proxy-Limitations" class="headerlink" title="JDK Dynamic Proxy Limitations:"></a>JDK Dynamic Proxy Limitations:</h3><ul>
<li>Only works with interfaces</li>
<li>Cannot intercept calls within the same class</li>
<li>Proxy must be accessed through the interface type</li>
</ul>
<h3 id="CGLIB-Limitations"><a href="#CGLIB-Limitations" class="headerlink" title="CGLIB Limitations:"></a>CGLIB Limitations:</h3><ul>
<li>Cannot proxy final classes or methods</li>
<li>May have issues with certain constructors</li>
<li>Requires careful handling of class loaders</li>
<li>May conflict with security managers in restricted environments</li>
</ul>
<h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Both JDK Dynamic Proxy and CGLIB provide powerful mechanisms for implementing proxies in Java applications. Understanding the differences and appropriate use cases for each approach helps developers make informed decisions when designing systems that require method interception.</p>
<p>In modern Spring applications, you rarely need to implement these proxies manually, as Spring’s AOP capabilities handle the details for you. However, understanding the underlying mechanisms helps when debugging issues or when you need to implement custom proxy behavior outside of Spring’s built-in capabilities.</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://example.com">victor holmes</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://example.com/2025/06/16/CGLIB/">http://example.com/2025/06/16/CGLIB/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/Spring/">Spring</a><a class="post-meta__tags" href="/tags/Proxy-Pattern/">Proxy Pattern</a><a class="post-meta__tags" href="/tags/CGLIB/">CGLIB</a><a class="post-meta__tags" href="/tags/AOP/">AOP</a></div><div class="post-share"><div class="social-share" data-image="/img/butterfly-icon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/03/07/hyperloglog/" title="Understanding HyperLogLog - Efficient Cardinality Estimation"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Understanding HyperLogLog - Efficient Cardinality Estimation</div></div><div class="info-2"><div class="info-item-1">HyperLogLog: Efficient Cardinality Estimation for Big DataThe Cardinality ProblemIn the world of big data, a common challenge is determining how many unique elements exist in a dataset without counting each one individually. For example:  How many unique users visited a website today? How many distinct search terms were used in the past hour? How many different IP addresses connected to a server?  When dealing with millions or billions of elements, storing each unique item to count them...</div></div></div></a><a class="pagination-related" href="/2025/06/29/bustub/" title="bustub"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">bustub</div></div><div class="info-2"><div class="info-item-1">Project 0 PrimerC++ basicstd::string vs std::string_viewstd::stringkeys of features  dynamic memory allocation mutable operation wide range of member functions  std::string_viewkeys of features  non-owing view : provide view or reference to an existing string light weight and efficient : assign or copy string_view is fast cause it only need to consider the reference ,length and start position of the string immutable operations : if someone just need to read the string ,should use the...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2024/12/01/HashMap/" title="Understanding HashMap Capacity Initialization in Java"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-12-01</div><div class="info-item-2">Understanding HashMap Capacity Initialization in Java</div></div><div class="info-2"><div class="info-item-1">Understanding HashMap’s Power-of-Two SizingIntroductionJava’s HashMap is one of the most commonly used data structures, offering O(1) average-case performance for lookups. One of its interesting implementation details is how it initializes its internal capacity. In this post, I’ll explain the elegant bit manipulation technique used to ensure the HashMap’s size is always a power of two. The tableSizeFor MethodAt the heart of HashMap’s initialization is the tableSizeFor method: 1234static...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/butterfly-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">victor holmes</div><div class="author-info-description">Hei guys, Welcome to my Blog :)</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">28</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Java-Proxy-Patterns-JDK-Dynamic-Proxy-vs-CGLIB"><span class="toc-number">1.</span> <span class="toc-text">Java Proxy Patterns: JDK Dynamic Proxy vs CGLIB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction-to-Proxy-Patterns"><span class="toc-number">1.1.</span> <span class="toc-text">Introduction to Proxy Patterns</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JDK-Dynamic-Proxy"><span class="toc-number">1.2.</span> <span class="toc-text">JDK Dynamic Proxy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Key-Characteristics"><span class="toc-number">1.2.1.</span> <span class="toc-text">Key Characteristics</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-JDK-Dynamic-Proxy-Works"><span class="toc-number">1.2.2.</span> <span class="toc-text">How JDK Dynamic Proxy Works</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Implementation-Example"><span class="toc-number">1.2.3.</span> <span class="toc-text">Implementation Example</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Define-an-Interface"><span class="toc-number">1.2.3.1.</span> <span class="toc-text">1. Define an Interface</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Implement-the-Interface"><span class="toc-number">1.2.3.2.</span> <span class="toc-text">2. Implement the Interface</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Create-an-InvocationHandler"><span class="toc-number">1.2.3.3.</span> <span class="toc-text">3. Create an InvocationHandler</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Create-and-Use-the-Proxy"><span class="toc-number">1.2.3.4.</span> <span class="toc-text">4. Create and Use the Proxy</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Output"><span class="toc-number">1.2.4.</span> <span class="toc-text">Output</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CGLIB-Proxy"><span class="toc-number">1.3.</span> <span class="toc-text">CGLIB Proxy</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Key-Characteristics-1"><span class="toc-number">1.3.1.</span> <span class="toc-text">Key Characteristics</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-CGLIB-Works"><span class="toc-number">1.3.2.</span> <span class="toc-text">How CGLIB Works</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Implementation-Example-1"><span class="toc-number">1.3.3.</span> <span class="toc-text">Implementation Example</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Add-CGLIB-Dependency"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">1. Add CGLIB Dependency</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Create-a-Target-Class-No-Interface-Required"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">2. Create a Target Class (No Interface Required)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Create-and-Use-the-CGLIB-Proxy"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">3. Create and Use the CGLIB Proxy</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Output-1"><span class="toc-number">1.3.4.</span> <span class="toc-text">Output</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Comparing-JDK-Dynamic-Proxy-and-CGLIB"><span class="toc-number">1.4.</span> <span class="toc-text">Comparing JDK Dynamic Proxy and CGLIB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#When-to-Use-Each-Approach"><span class="toc-number">1.5.</span> <span class="toc-text">When to Use Each Approach</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Use-JDK-Dynamic-Proxy-When"><span class="toc-number">1.5.1.</span> <span class="toc-text">Use JDK Dynamic Proxy When:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Use-CGLIB-When"><span class="toc-number">1.5.2.</span> <span class="toc-text">Use CGLIB When:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#How-Spring-Framework-Uses-Proxies"><span class="toc-number">1.6.</span> <span class="toc-text">How Spring Framework Uses Proxies</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Limitations-and-Considerations"><span class="toc-number">1.7.</span> <span class="toc-text">Limitations and Considerations</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JDK-Dynamic-Proxy-Limitations"><span class="toc-number">1.7.1.</span> <span class="toc-text">JDK Dynamic Proxy Limitations:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CGLIB-Limitations"><span class="toc-number">1.7.2.</span> <span class="toc-text">CGLIB Limitations:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Conclusion"><span class="toc-number">1.8.</span> <span class="toc-text">Conclusion</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/14/voting-dapp-with-anchor/" title="voting-dapp with anchor">voting-dapp with anchor</a><time datetime="2025-08-14T06:47:42.000Z" title="Created 2025-08-14 14:47:42">2025-08-14</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/07/ChangeBuffer/" title="MySQL Change Buffer - Boosting Write Performance">MySQL Change Buffer - Boosting Write Performance</a><time datetime="2025-08-07T06:09:07.000Z" title="Created 2025-08-07 14:09:07">2025-08-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/05/bustub-Project-1-buffer/" title="BusTub Project 1 - Buffer Pool Manager Implementation">BusTub Project 1 - Buffer Pool Manager Implementation</a><time datetime="2025-07-05T06:37:55.000Z" title="Created 2025-07-05 14:37:55">2025-07-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/29/bustub/" title="bustub">bustub</a><time datetime="2025-06-29T06:06:55.000Z" title="Created 2025-06-29 14:06:55">2025-06-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/16/CGLIB/" title="Understanding Java Proxy Patterns - JDK Dynamic Proxy vs CGLIB">Understanding Java Proxy Patterns - JDK Dynamic Proxy vs CGLIB</a><time datetime="2025-06-16T06:32:40.000Z" title="Created 2025-06-16 14:32:40">2025-06-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2025 By victor holmes</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>